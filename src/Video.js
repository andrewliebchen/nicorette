import React, { Component } from "react";
import styled from "styled-components";
import PropTypes from "prop-types";
import Color from "color";
import { Flex, Box } from "reflexbox";
import ReactInterval from "react-interval";

const Root = styled(Flex)`
  height: 100%;
  width: 100%;
`;

const Control = styled(Box)`
  cursor: pointer;
  user-select: none;
`;

class Video extends Component {
  constructor(props) {
    super(props);
    this.state = {
      playing: false,
      rotation: 20,
      speed: 50
    };
    this._renderToggle = this._renderToggle.bind(this);
  }

  _renderToggle() {
    return (
      <svg width={50} viewBox="0 0 200 200">
        <g fill="white">
          {this.state.playing ? (
            <path d="M194.587711,49.2723493 C198.736241,66.7359667 200.188226,84.4074844 199.9808,100 C200.188226,115.592516 198.736241,133.264033 194.587711,150.727651 C194.587711,150.727651 188.157489,181.496881 160.362338,192.307692 C147.294469,197.505198 123.440421,199.7921 100.001227,200 C76.5620323,199.7921 52.7079848,197.297297 39.6401153,192.307692 C11.8449643,181.496881 5.41474279,150.727651 5.41474279,150.727651 C1.05878629,133.471933 -0.185772711,115.592516 0.0216537891,100 C-0.185772711,84.4074844 1.26621279,66.7359667 5.41474279,49.2723493 C5.41474279,49.2723493 11.8449643,18.5031185 39.6401153,7.69230769 C52.7079848,2.7027027 76.5620323,0.207900208 100.001227,0 C123.440421,0.207900208 147.294469,2.7027027 160.362338,7.69230769 C188.157489,18.5031185 194.587711,49.2723493 194.587711,49.2723493 Z M74,60 C66.8202983,60 61,65.8202983 61,73 L61,127 C61,134.179702 66.8202983,140 74,140 C81.1797017,140 87,134.179702 87,127 L87,73 C87,65.8202983 81.1797017,60 74,60 Z M126,60 C118.820298,60 113,65.8202983 113,73 L113,127 C113,134.179702 118.820298,140 126,140 C133.179702,140 139,134.179702 139,127 L139,73 C139,65.8202983 133.179702,60 126,60 Z" />
          ) : (
            <path d="M194.587711,49.2723493 C194.587711,49.2723493 188.157489,18.5031185 160.362338,7.69230769 C147.294469,2.7027027 123.440421,0.207900208 100.001227,0 C76.5620323,0.207900208 52.7079848,2.7027027 39.6401153,7.69230769 C11.8449643,18.5031185 5.41474279,49.2723493 5.41474279,49.2723493 C1.26621279,66.7359667 -0.185772711,84.4074844 0.0216537891,100 C-0.185772711,115.592516 1.05878629,133.471933 5.41474279,150.727651 C5.41474279,150.727651 11.8449643,181.496881 39.6401153,192.307692 C52.7079848,197.297297 76.5620323,199.7921 100.001227,200 C123.440421,199.7921 147.294469,197.505198 160.362338,192.307692 C188.157489,181.496881 194.587711,150.727651 194.587711,150.727651 C198.736241,133.264033 200.188226,115.592516 199.9808,100 C200.188226,84.4074844 198.736241,66.7359667 194.587711,49.2723493 Z M137.75285,106.029106 L89.0076223,137.422037 C87.5556368,138.461538 85.8962248,138.877339 84.0293863,138.877339 C82.5774008,138.877339 81.1254153,138.461538 79.6734298,137.837838 C76.7694588,136.174636 74.9026203,133.264033 74.9026203,129.93763 L74.9026203,67.1517672 C74.9026203,63.8253638 76.7694588,60.7068607 79.6734298,59.2515593 C82.5774008,57.5883576 86.1036513,57.7962578 88.8001958,59.6673597 L137.545423,91.0602911 C140.241968,92.7234927 141.693953,95.6340956 141.693953,98.7525988 C141.693953,101.871102 140.449394,104.365904 137.75285,106.029106 Z" />
          )}
        </g>
      </svg>
    );
  }

  render() {
    const { playing, rotation, speed } = this.state;
    const hue = Color(this.props.hue.base).saturate(1);

    return (
      <Root
        align="center"
        justify="center"
        style={{
          backgroundImage: `linear-gradient(${rotation}deg, ${hue}, ${hue.rotate(
            rotation
          )})`
        }}
      >
        <Control onClick={() => this.setState({ playing: !playing })}>
          {this._renderToggle()}
        </Control>
        <ReactInterval
          timeout={speed}
          enabled={playing}
          callback={() => this.setState({ rotation: rotation + 1 })}
        />
      </Root>
    );
  }
}

Video.propTypes = {
  hue: PropTypes.object
};

export default Video;
